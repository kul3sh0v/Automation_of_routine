- name: Check OS is Ubuntu or Debian
  assert:
    that:
      - ansible_facts['os_family'] == 'Debian'
      - ansible_facts['distribution'] in ['Ubuntu', 'Debian']
    fail_msg: "This playbook only supports Ubuntu or Debian"
    success_msg: "OS check passed"

- name: Update apt cache
  apt:
    update_cache: true
    cache_valid_time: 3600

- name: Install base packages
  apt:
    name:
      - ca-certificates
      - curl
      - unzip
      - openssl
      - ufw
    state: present

- name: Enable IPv4 forwarding
  sysctl:
    name: net.ipv4.ip_forward
    value: "1"
    state: present
    reload: true
